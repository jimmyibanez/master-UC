var powerbi,__awaiter=this&&this.__awaiter||function(e,i,s,d){return new(s=s||Promise)(function(n,t){function a(e){try{o(d.next(e))}catch(e){t(e)}}function r(e){try{o(d.throw(e))}catch(e){t(e)}}function o(e){var t;e.done?n(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(a,r)}o((d=d.apply(e,i||[])).next())})},__generator=this&&this.__generator||function(n,a){var r,o,i,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},d={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(d[Symbol.iterator]=function(){return this}),d;function e(t){return function(e){return function(t){if(r)throw new TypeError("Generator is already executing.");for(;d&&t[d=0]&&(s=0),s;)try{if(r=1,o&&(i=2&t[0]?o.return:t[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,t[1])).done)return i;switch(o=0,(t=i?[2&t[0],i.value]:t)[0]){case 0:case 1:i=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,o=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(i=0<(i=s.trys).length&&i[i.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!i||t[1]>i[0]&&t[1]<i[3])){s.label=t[1];break}if(6===t[0]&&s.label<i[1]){s.label=i[1],i=t;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(t);break}i[2]&&s.ops.pop(),s.trys.pop();continue}t=a.call(n,s)}catch(e){t=[6,e],o=0}finally{r=i=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}};function addOrUpdateQueryString(e,t,n){n=parseQueryString(n=void 0===n?window.location.search:n);return n[e]=t,rebuildQueryString(n)}function clearQueryString(e,t){t=parseQueryString(t=void 0===t?window.location.search:t);return delete t[e],rebuildQueryString(t)}function parseQueryString(e){var t={},e=e=void 0===e?window.location.search:e;if(e&&"?"===e.substr(0,1))for(var n=0,a=e.substr(1).split("&");n<a.length;n++){var r=a[n].split("="),o=r[0],r=r.slice(1).join("=");t[decodeURIComponent(o)]=decodeURIComponent(r)}return t}function rebuildQueryString(e){var t,n="",a=!0;for(t in e)a||(n+="&"),n+=encodeURIComponent(t)+"=",e[t]&&(n+=encodeURIComponent(e[t])),a=!1;return n=!a?"?"+n:n}function setCookie(e,t,n,a,r){void 0===n&&(n="/"),void 0===a&&(a="none"),r||(r=new Date).setFullYear(r.getFullYear()+1),window&&window.document&&(window.document.cookie=e+" = "+t+";secure;path="+n+";expires="+r.toUTCString()+";samesite="+a)}function startBaseMetadataLogRequest(e,t,n){t={url:e,start:new Date,requestId:t};return window[n].push(t),t}function endBaseMetadataLogRequest(e,t,n,a,r,o,i){e.end=new Date,e.isError=t,e.code=n,e.errorMessage=a,e.parseStart=o,e.parseEnd=i,e.size=r}function getBaseMetadata(n){var a=window;return new Promise(function(e,t){a.clientAuthEnabled?a.signInPromise.then(function(){window.baseMetadataFromClient?getBaseMetadataInternal(!1,n).then(function(){e(!0)}).catch(function(){e(!0)}):e(!0)}).catch(function(){t(!0)}):window.baseMetadataFromClient?getBaseMetadataInternal(!1,n).then(function(){e(!0)}).catch(function(){e(!0)}):e(!0)})}function getBaseMetadataInternal(B,P){var q=window;return new Promise(function(C,L){var e=window.clusterUri,t=("/"===e.substring(e.length-1)?e:e+"/")+"metadata/bootstrap/base",e=B?window.baseMetadataRetryRequestId:window.baseMetadataRequestId,R=startBaseMetadataLogRequest(t,e,"getBaseMetadataInfo");try{var M=new XMLHttpRequest;M.open("GET",t,!0),M.setRequestHeader("Accept","application/json"),M.setRequestHeader("Authorization","Bearer "+window.powerBIAccessToken),M.setRequestHeader("ActivityId",window.telemetrySessionId),M.setRequestHeader("RequestId",e),M.setRequestHeader("X-PowerBI-Auto-License-Info","AutoLicenseAssignmentSupported"),null!==window.aadConsistencyHeaderScenarioId&&""!==window.aadConsistencyHeaderScenarioId&&M.setRequestHeader("ConsistencyLevel","Organization;ScenarioId="+window.aadConsistencyHeaderScenarioId),null!==powerbi.getQueryStringValue("redirectedFromSignup")&&M.setRequestHeader("X-PowerBI-RedirectedFromSignup","true"),M.onreadystatechange=function(){return __awaiter(this,void 0,void 0,function(){var a,r,o,i,s,d,u,c,w,l,g,f,p,h,m,v,b,y,S,I=this;return __generator(this,function(e){switch(e.label){case 0:return(e.trys.push([0,11,,12]),M.readyState!==XMLHttpRequest.DONE)?[3,10]:(a=M.status,r=M.getAllResponseHeaders(),200<=a&&a<300||304===a?(o=new Date,g=JSON.parse(M.responseText),u=new Date,window.powerbi,window.featureSwitches=g.clientFeatureSwitches,window.placeExpAssignmentContextOnPage&&(window.expAssignmentContext=g.expAssignmentContext),g&&g.branding&&g.branding.config&&(i=JSON.parse(g.branding.config),s={},Object.keys(i).forEach(function(e){var t=e[0].toLowerCase()+e.substring(1);s[t]=i[e]}),g.branding.config=s),window.placeBrandingInfoOnPage&&(window.brandInfo=g.branding),window.placeAutoLicenseAssignmentStateOnPage&&(h=void 0,!r||-1===r.indexOf("x-powerbi-auto-license-info")&&-1===r.indexOf("X-PowerBI-Auto-License-Info")||(h=M.getResponseHeader("x-powerbi-auto-license-info")),d=!1,h&&h.toLowerCase()==="AutoLicenseAssignmentSucceeded".toLowerCase()&&(t=-1!==P.href.indexOf("/teams"),n=function(e){for(var t=0,n=["iphone","ipad","android"];t<n.length;t++){var a=n[t];if(e.toLowerCase().includes(a))return!0}return!1}(window.navigator.userAgent),t&&n&&(P.href="/TeamsMobileAutoLicense?originalUrl="+encodeURIComponent(P.href)),d=!0),A()&&(A().hasAutoAssignedLicense=d),window.hasAutoAssignedLicense=d),(d=g.userSettings.preferredLanguage)&&0<d.length?(setCookie("PreferredLanguage",d),d.toLowerCase()!==x().toLowerCase()&&null===powerbi.getQueryStringValue("language")&&(b=P.origin+P.pathname,y=addOrUpdateQueryString("language",d,P.search),P.href=b+y)):""===d&&(setCookie("PreferredLanguage",d),window.navigator&&window.navigator.language&&window.navigator.language.toLowerCase()!==x().toLowerCase()&&null===powerbi.getQueryStringValue("language")&&(b=P.origin+P.pathname,y=addOrUpdateQueryString("language",window.navigator.language,P.search),P.href=b+y)),endBaseMetadataLogRequest(R,!1,a.toString(),void 0,M.responseText.length,o,u),C(g),[3,10]):[3,1]);case 1:if(!isCAEClaimChallenge(a,M)||!q.teamsCAE||"Teams"!==q.hostPlatformName&&"TeamsModern"!==q.hostPlatformName&&!0!==q.inTeams)return[3,2];for(u=q.metaOSAccessTokenKeyPrefix+q.hostPlatformName+"_"+q.hostPlatformType,g=q.metaOSUserInfoKeyPrefix+q.hostPlatformName+"_"+q.hostPlatformType,c=0,w=[u,g];c<w.length;c++)l=w[c],window.localStorage.removeItem(l);return(g=new URL(P.href)).searchParams.append("TeamsCAEinWFE","true"),P.href="/teams/TeamsAuthentication?"+encodeURIComponent(g.toString()),[3,10];case 2:return(f="UserNotLicensed",p=void 0,!r||-1===r.indexOf("x-powerbi-error-info")&&-1===r.indexOf("X-PowerBI-Error-Info")||(p=M.getResponseHeader("x-powerbi-error-info")),0===a&&!p&&window.navigator&&(p="NavigatorOnLineProperty="+window.navigator.onLine),0===a||404===a||408===a||500<=a&&a<600)?B?[3,7]:0!==a?[3,3]:(setTimeout(function(){return __awaiter(I,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,getBaseMetadataInternal(!0,P)];case 1:return t=e.sent(),C(t),[3,3];case 2:return t=e.sent(),L(t),[3,3];case 3:return[2]}})})},1e3),[3,6]):[3,9];case 3:return e.trys.push([3,5,,6]),[4,getBaseMetadataInternal(!0,P)];case 4:return m=e.sent(),C(m),[3,6];case 5:return v=e.sent(),L(v),[3,6];case 6:return[3,8];case 7:endBaseMetadataLogRequest(R,!0,a.toString(),p,void 0,void 0,void 0),L(p),e.label=8;case 8:return[3,10];case 9:p&&p.toLowerCase()===f.toLowerCase()?(endBaseMetadataLogRequest(R,!0,a.toString(),p,void 0,void 0,void 0),h=void 0,(h=r&&(-1!==r.indexOf("x-powerbi-auto-license-info")||-1!==r.indexOf("X-PowerBI-Auto-License-Info"))?M.getResponseHeader("x-powerbi-auto-license-info"):h)&&h.toLowerCase()==="AutoLicenseAssignmentDisabledByTenant".toLowerCase()?P.href="https://aka.ms/pbiAdHocSubscriptionNotAllowed":(S=window.staticPageRedirectInTeams,m=powerbi.getQueryStringValue("route"),v=-1!==P.href.indexOf("/teams/"),y=b=void 0,b=m&&0<m.length?(y=clearQueryString("route",P.search),P.origin+"/"+m):(y=P.search,P.origin+P.pathname),P.href=v&&S?"/StaticTeamsSignUp?originalUrl="+encodeURIComponent(P.href)+"&redirectUrl="+encodeURIComponent(b+y):"/SignupRedirect?ru="+b+y)):endBaseMetadataLogRequest(R,!0,a.toString(),p,void 0,void 0,void 0),L(p),e.label=10;case 10:return[3,12];case 11:return S=e.sent(),R.end||endBaseMetadataLogRequest(R,!0,a.toString(),S.message,void 0,void 0,void 0),L(S.message),[3,12];case 12:return[2]}var t,n})})},M.send()}catch(e){R.end||endBaseMetadataLogRequest(R,!0,"No status code",e.message,void 0,void 0,void 0),L(e.message)}function A(){return function(){var e=n();e.session||(e.session={});return e.session}().userInfo}function x(){return function(){var e=n();e.common||(e.common={});return e.common}().cultureInfo}function n(){return window.powerbi||(window.powerbi={}),window.powerbi}})}(powerbi||(powerbi={})).getQueryStringValue=function(e,t){for(var n=(t=t||window.location.search).substr(1).split("&"),a=0,r=n.length;a<r;++a){var o=n[a].split("=");if(o[0]===e)return decodeURIComponent(o[1])}return null};var baseMetadataWindow=window;function isCAEClaimChallenge(e,t){t=t.getResponseHeader("WWW-Authenticate");return 401===e&&(null==t?void 0:t.includes("error"))}baseMetadataWindow.getBaseMetadataInfo=[],baseMetadataWindow.deferBaseMetadataPromise?baseMetadataWindow.getBaseMetadata=getBaseMetadata:baseMetadataWindow.baseMetadataPromise=getBaseMetadata(window.location);